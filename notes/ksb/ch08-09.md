## CH 08 - 09

### 설계

코드를 더 쉽게 추가/변경하고 테스트하는데 도움이 되는 방법론

### 계층형 설계라는 설계 방법론

계층형 설계는 코드를 분리하는 방법으로, 추상화 수준을 기준으로 한다.

### 계층의 기준

계층 간의 관계: 이 때, 직전 하위 계층으로 상위 계층을 구상하는 것

### 추상화 수준의 기준

(TBD)

### 좋은 설계를 위한 감각

> 각 계층을 정확히 구분하기는 어렵다.

#### 나쁜 설계인지 판단하는 방법

다음 세 가지를 확인할 수 있다.

- 함수 시그니처
- 함수 본문
- 계층 구조

함수 시그니처의 ...

- 이름
- 파라미터 이름
- 파라미터와 반환값의 타입

함수 본문의 ...

- 길이
- 복잡도
- 구체성의 정도
  - (ex) 호출하는 함수
  - (ex) 사용하는 문법 (if, for, ...)

### 계층형 설계 패턴의 기준과 원칙

> 전체 계층의 구성은 직접 해야 한다. 각 계층 별 추상화 정도는 정해져 있지 않다.
>
> - 여러 Use Case들을 직접 코딩해보고 장단점을 깨우쳐야 할 듯하다.
> - 아마도 계층이 잘게 나뉠수록 코드를 추가/개선할 때 매번 계층을 고려해야 하는 어려움이 추가될 듯하다.
> - 대신 잘 구성된 계층은 유지보수가 쉬울 것이다. (러닝커브와 생산성 간의 트레이드 오프 관계이지 않을까.)

다음을 만족하면 계층형 설계가 잘 된 것이다:

- 추상적인 수준의 코드로 추상적인 코드를 작성할 수 있다.
- 함수 본문이 같은 추상화 단계의 기능만을 사용한다.

다음을 만족하면 계층형 설계가 잘못 된 것이다:

- 코드가 충분히 추상적이지 않다.
- 함수 본문이 서로 다른 추상화 단계의 기능을 사용한다.

그럴 땐 이렇게 한다:

- 직접 구현하지 않고 위임한다. 각 계층의 추상화 수준에 맞을 때까지.
  - (ex) `공짜 클립을 받을 수 있는지 계산`할 때 장바구니의 구현을 모르게 한다.
    - 직접 계산하면 배열을 순회하는 코드를 갖게 되므로, 장바구니의 구현과 결합하게 된다.
    - 이를 위임함으로써 장바구니의 구현을 모른 채 장바구니를 사용할 수 있게 한다.
    - 동일한 원리로, `장바구니에 물건 추가` 등도 함수로 추출하여 장바구니의 구현을 숨긴다.
-

GOOD:
BAD:
-> THEN:

GOOD:
BAD:
-> THEN:

GOOD:
BAD:
-> THEN:

### 계층형 설계 요약
